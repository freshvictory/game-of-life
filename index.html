<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Conway's Game of Life</title>
  <link rel="stylesheet" href="main.css">
</head>

<body>
  <h1>Conway's Game of Life</h1>
  <form id="controls">
    <div class="inputs">
      <div class="input-row">
        <label for="board-size-slider">Pixels/cell</label>
        <input type="range" name="board-size" id="board-size-slider" value="1" step="1" min="0" max="7">
      </div>
      <div class="input-row">
        <label for="speed-slider">Speed</label>
        <input type="range" name="speed" id="speed-slider" value="4" step="1" min="0" max="6">
      </div>
      <div class="input-row">
        <label for="probability-slider">Probability</label>
        <input type="range" name="probability" id="probability-slider" value="4" step="1" min="0" max="7">
      </div>
      <div class="input-row">
        <label for="cell-color-picker">Cell color</label>
        <input type="color" value="#8d5fbb" id="cell-color-picker">
      </div>
      <div class="input-row">
        <label for="background-color-picker">Background color</label>
        <input type="color" value="#000000" id="background-color-picker">
      </div>
    </div>
    <div class="actions">
      <button id="run-button" type="submit">Run</button>
      <button id="stop-button" type="button">Stop</button>
    </div>
  </form>
  <canvas id="canvas" width="800" height="800"></canvas>
  <script type="module">
    import { run, stop } from './index.js';

    const controlForm = document.getElementById('controls');
    const boardSizeSlider = document.getElementById('board-size-slider');
    const speedSlider = document.getElementById('speed-slider');
    const probabilitySlider = document.getElementById('probability-slider');
    const cellColorPicker = document.getElementById('cell-color-picker');
    const backgroundColorPicker = document.getElementById('background-color-picker');
    const stopButton = document.getElementById('stop-button');
    const canvas = document.getElementById('canvas');
    stopButton.addEventListener('click', function () {
      stop(canvas);
    });
    controlForm.addEventListener('submit', function (event) {
      event.preventDefault();
      const cellSize = parseInt(boardSizeSlider.value, 10);
      const cellSizes = [1, 2, 4, 5, 8, 10, 20, 25];
      const speed = parseInt(speedSlider.value, 10);
      const speeds = [0.16, 0.25, 0.3, 0.5, 1, 2, 3];
      const probability = parseInt(probabilitySlider.value, 10);
      const probabilities = [0.05, 0.1, 0.2, 0.3, 0.5, 0.7, 0.8, 0.9];
      const rgb = [
        parseInt(cellColorPicker.value.substring(1, 3), 16),
        parseInt(cellColorPicker.value.substring(3, 5), 16),
        parseInt(cellColorPicker.value.substring(5, 7), 16)
      ];
      canvas.style.setProperty('--c-background', backgroundColorPicker.value);
      run({
        canvas,
        cellSize: cellSizes[cellSize],
        speed: speeds[speed],
        probability: probabilities[probability],
        color: rgb
      });
    });
  </script>
</body>

</html>
